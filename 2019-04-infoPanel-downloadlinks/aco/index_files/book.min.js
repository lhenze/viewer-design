/*! aco-site 2019-04-14 */
YUI().use("node","anim","crossframe","router","event-resize","querystring-parse",function(a){"use strict";function b(){var b=i.siblings(),c=a.DOM.viewportRegion(),d=c.height;if(b.each(function(a){d-=a.get("offsetHeight")}),h.hasClass("io-loading")){var e=a.one(".bubblingG"),f=e.get("offsetHeight");d+=f}return d}function c(){i.setStyles({height:b()})}function d(){i.siblings().each(function(a){a.addClass("hiddenSiblings")}),c()}function e(){i.siblings().each(function(a){a.removeClass("hiddenSiblings")}),c()}function f(a){var b=i.getAttribute("data-sourceUrl"),c=(i.getAttribute("data-bookTheme"),a.params.identifier),d=a.params.page?a.params.page:1;i.setAttribute("data-identifier",c),"replace"===a.src&&(b=b+"/books/"+a.params.identifier+"/"+d+"?embed=1&lang="+g.lang,i.set("src",b))}var g={lang:"en"};window.location.search.length&&(g=a.QueryString.parse(window.location.search.replace(/\?/i,"")));var h=a.one("body"),i=a.one(".widget.book"),j=h.getAttribute("data-appRoot");h.addClass("io-loading");var k=new a.Router({root:j,routes:[{path:"/book/:identifier/:page",callbacks:f},{path:"/book/:identifier",callbacks:f}]});a.on("windowresize",c),a.on("button:button-fullscreen:on",d),a.on("button:button-fullscreen:off",e),a.on("openlayers:change",function(a){k.save("/book/"+i.getAttribute("data-identifier")+"/"+a.sequence)}),a.on("change:option:multivolume",function(a){var b=a.url.split("/");if(b[3]){var c="/book/"+b[3]+"/1";k.replace(c)}}),a.on("display:load",function(b){document.title=b.title+": "+a.one('meta[property="og:site_name"]').get("content")}),a.Global.on("crossframe:message",function(b,c){var d=JSON.parse(c.message);a.fire(d.fire,d.data)}),i.on("load",function(){var b=new a.Anim({node:this,to:{opacity:1},duration:.3});c(),b.run(),h.removeClass("io-loading")}),c(),k.replace(k.getPath())});